<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Modo Claro / Escuro</title>

    <style>
      /* -----------------------------------------
       Usamos vari√°veis CSS para facilitar troca
       ----------------------------------------- */
      :root {
        --bg: #ffffff;
        --fg: #111111;
        --card: #f2f2f2;
        --accent: #0066cc;
        --transition: 200ms ease;
      }

      /* tema escuro (quando atributo data-theme="dark" estiver no <html>) */
      html[data-theme="dark"] {
        --bg: #0f1220;
        --fg: #e6e7ea;
        --card: #151826;
        --accent: #4ea3ff;
      }

      /* Se o usu√°rio n√£o escolheu nada, respeitamos a prefer√™ncia do sistema */
      @media (prefers-color-scheme: dark) {
        :root {
          /* estas s√£o valores iniciais caso o user n√£o tenha escolha salva */
          --bg: #0f1220;
          --fg: #e6e7ea;
          --card: #151826;
          --accent: #4ea3ff;
        }
      }

      /* reset e layout simples */
      * {
        box-sizing: border-box;
      }
      html,
      body {
        height: 100%;
        margin: 0;
      }
      body {
        font-family: system-ui, -apple-system, "Segoe UI", Roboto,
          "Helvetica Neue", Arial;
        background: var(--bg);
        color: var(--fg);
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 2rem;
        transition: background var(--transition), color var(--transition);
      }

      .card {
        background: var(--card);
        padding: 1.5rem;
        border-radius: 12px;
        box-shadow: 0 6px 18px rgba(0, 0, 0, 0.08);
        width: 100%;
        max-width: 520px;
        transition: background var(--transition), box-shadow var(--transition);
      }

      header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 1rem;
      }
      h1 {
        margin: 0;
        font-size: 1.25rem;
      }

      /* Toggle estilo (simples, acess√≠vel) */
      .toggle {
        --w: 52px;
        --h: 30px;
        position: relative;
        width: var(--w);
        height: var(--h);
      }

      .toggle input {
        position: absolute;
        inset: 0;
        width: 100%;
        height: 100%;
        opacity: 0;
      }

      .track {
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.12);
        border-radius: 999px;
        display: flex;
        align-items: center;
        padding: 4px;
        transition: background var(--transition);
      }

      html[data-theme="dark"] .track {
        background: rgba(255, 255, 255, 0.12);
      }

      .thumb {
        width: calc(var(--h) - 8px);
        height: calc(var(--h) - 8px);
        background: white;
        border-radius: 50%;
        box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2);
        transform: translateX(0);
        transition: transform var(--transition), background var(--transition);
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 12px;
      }

      /* posi√ß√£o quando dark (movemos o "thumb" para a direita) */
      html[data-theme="dark"] .thumb {
        transform: translateX(calc(var(--w) - var(--h)));
        background: #222; /* ajuste visual para dark */
        color: var(--fg);
      }

      /* foco acess√≠vel */
      .toggle input:focus + .track {
        outline: 3px solid color-mix(in srgb, var(--accent) 40%, transparent);
        outline-offset: 3px;
      }

      p {
        margin-top: 1rem;
        line-height: 1.5;
      }
      .note {
        font-size: 0.9rem;
        opacity: 0.9;
        margin-top: 0.75rem;
      }
    </style>
  </head>
  <body>
    <main class="card" role="main">
      <header>
        <div>
          <h1>Modo Claro / Escuro</h1>
          <div class="note">
            Alterna entre temas; a escolha √© lembrada no navegador.
          </div>
        </div>

        <!-- Toggle control: checkbox escondido + visual -->
        <label
          class="toggle"
          aria-label="Alternar tema claro e escuro"
          title="Alternar tema"
        >
          <input
            id="theme-toggle"
            type="checkbox"
            role="switch"
            aria-checked="false"
          />
          <span class="track" aria-hidden="true">
            <span class="thumb" aria-hidden="true">‚òÄÔ∏è</span>
          </span>
        </label>
      </header>

      <p>
        Exemplo de conte√∫do para ver o contraste. Troque o tema usando o
        interruptor no canto.
      </p>
    </main>

    <script>
      (function () {
        const root = document.documentElement; // <html>
        const toggle = document.getElementById("theme-toggle");
        const storageKey = "site-theme"; // chave para localStorage

        // 1) Fun√ß√£o para aplicar tema: "light" | "dark" | null (null -> remove prefer√™ncia)
        function applyTheme(theme) {
          if (theme === "dark") {
            root.setAttribute("data-theme", "dark");
            toggle.checked = true;
            toggle.setAttribute("aria-checked", "true");
            // deixar o √≠cone apropriado
            root.querySelector(".thumb").textContent = "üåô";
          } else if (theme === "light") {
            root.setAttribute("data-theme", "light"); // opcional; nossos estilos default v√™m de :root
            toggle.checked = false;
            toggle.setAttribute("aria-checked", "false");
            root.querySelector(".thumb").textContent = "‚òÄÔ∏è";
          } else {
            // remove atributo para que o media query do sistema possa agir
            root.removeAttribute("data-theme");
            // define checkbox conforme prefer√™ncia do sistema
            const prefersDark =
              window.matchMedia &&
              window.matchMedia("(prefers-color-scheme: dark)").matches;
            toggle.checked = prefersDark;
            toggle.setAttribute("aria-checked", String(prefersDark));
            root.querySelector(".thumb").textContent = prefersDark
              ? "üåô"
              : "‚òÄÔ∏è";
          }
        }

        // 2) Inicializa√ß√£o: l√™ localStorage e aplica
        const saved = localStorage.getItem(storageKey); // 'dark' | 'light' | null
        if (saved === "dark" || saved === "light") {
          applyTheme(saved);
        } else {
          // sem prefer√™ncia salva -> seguir prefer√™ncia do sistema
          applyTheme(null);
        }

        // 3) Ao clicar/trocar o toggle, atualizamos o tema e salvamos
        toggle.addEventListener("change", function () {
          if (this.checked) {
            applyTheme("dark");
            localStorage.setItem(storageKey, "dark");
          } else {
            applyTheme("light");
            localStorage.setItem(storageKey, "light");
          }
        });

        // 4) Se o usu√°rio mudar a prefer√™ncia do sistema enquanto estiver sem prefer√™ncia salva,
        //    refletimos isso (apenas quando n√£o h√° prefer√™ncia salva)
        if (window.matchMedia) {
          const mq = window.matchMedia("(prefers-color-scheme: dark)");
          mq.addEventListener
            ? mq.addEventListener("change", (e) => {
                if (!localStorage.getItem(storageKey)) applyTheme(null);
              })
            : mq.addListener((e) => {
                if (!localStorage.getItem(storageKey)) applyTheme(null);
              });
        }

        // Sugest√£o opcional: expose function to clear saved preference (useful para debug)
        window.clearThemePreference = () => {
          localStorage.removeItem(storageKey);
          applyTheme(null);
        };
      })();
    </script>
  </body>
</html>
